<!DOCTYPE html>
<html>

<head>
	<style>
		#info {
			position: absolute;
			top: 45%;
			width: 100%;
			font-family: 'Courier New', monospace;

			padding: 5px;
			text-align: center;
			font-size: 50px;
			color: #6f7896;
		}

		body {
			/*background-image: linear-gradient(to top, #fbc2eb 0%, #a6c1ee 100%);*/
			background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
			margin: 0px;
			overflow: hidden;
		}

		button {
			border: none;
			color: #6f7896;
			background-color: Transparent;
			border-radius: 8px;
			transition-duration: 0.4s;
			/* Safari */
			transition-duration: 0.4s;
			border: 1px solid #6f7896;
		}

		button:hover {
			border: 1px solid #96B9F2;
			background-color: Transparent;
			color: #6f7896;
			box-shadow: 0 5px 20px 0 rgba(0, 0, 0, 0.54), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
		}
		
	</style>
</head>

<body>
	<!--
        <div id='info'> DESCENDANTS<br>OF THE ABACUS <br>
        </div>
-->
	<script src="https://threejs.org/build/three.min.js"></script>
	<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
	<script src="https://threejs.org/examples/js/libs/dat.gui.min.js"></script>

	<script>
		javascript: (function() {
			var script = document.createElement('script');
			script.onload = function() {
				var stats = new Stats();
				document.body.appendChild(stats.dom);
				requestAnimationFrame(function loop() {
					stats.update();
					requestAnimationFrame(loop)
				});
			};
			script.src = 'https://mrdoob.github.io/stats.js/build/stats.min.js';
			document.head.appendChild(script);
		})()

		var camera, scene, renderer, geometry, material, mesh, cylinder_group, box_group, controls;
		var PI = 3.1415926;
		var spotLight, spotLight_box;
		init();
		animate();

		function addDatGui() {
			var gui = new dat.GUI();

			var camera_position_control = gui.addFolder('camera_position');
			camera_position_control.add(camera.position, 'x', -500, 500).step(0.1);
			camera_position_control.add(camera.position, 'y', -500, 500).step(0.1);
			camera_position_control.add(camera.position, 'z', -500, 500).step(0.1);

			var camera_rotation_control = gui.addFolder('camera_rotation');
			camera_rotation_control.add(camera.rotation, 'x', -500, 500).step(0.1);
			camera_rotation_control.add(camera.rotation, 'y', -500, 500).step(0.1);
			camera_rotation_control.add(camera.rotation, 'z', -500, 500).step(0.1);

			var spotLight_box_position_control = gui.addFolder('spotlight_box_position');
			spotLight_box_position_control.add(spotLight_box.position, 'x', -3000, 3000).step(0.1);
			spotLight_box_position_control.add(spotLight_box.position, 'y', -3000, 3000).step(0.1);
			spotLight_box_position_control.add(spotLight_box.position, 'z', -3000, 3000).step(0.1);

			var spotlight_position_control = gui.addFolder('spotlight_position');
			spotlight_position_control.add(spotLight.position, 'x', -3000, 3000).step(0.001);
			spotlight_position_control.add(spotLight.position, 'y', -3000, 3000).step(0.001);
			spotlight_position_control.add(spotLight.position, 'z', -3000, 3000).step(0.001);

			var cylinder_group_position_control = gui.addFolder('cylinder_group_position');
			cylinder_group_position_control.add(cylinder_group.position, 'x', -1000, 1000).step(0.1);
			cylinder_group_position_control.add(cylinder_group.position, 'y', -1000, 1000).step(0.1);
			cylinder_group_position_control.add(cylinder_group.position, 'z', -1000, 1000).step(0.1);


			var cylinder_group_rotation_control = gui.addFolder('cylinder_group_rotation');
			cylinder_group_rotation_control.add(cylinder_group.rotation, 'x', -2 * Math.PI, 2 * Math.PI).step(0.001);
			cylinder_group_rotation_control.add(cylinder_group.rotation, 'y', -2 * Math.PI, 2 * Math.PI).step(0.001);
			cylinder_group_rotation_control.add(cylinder_group.rotation, 'z', -2 * Math.PI, 2 * Math.PI).step(0.001);

			var box_group_position_control = gui.addFolder('box_group_position');
			box_group_position_control.add(box_group.position, 'x', -1000, 1000).step(0.1);
			box_group_position_control.add(box_group.position, 'y', -1000, 1000).step(0.1);
			box_group_position_control.add(box_group.position, 'z', -1000, 1000).step(0.1);

			var box_group_rotation_control = gui.addFolder('box_group_rotation');
			box_group_rotation_control.add(box_group.rotation, 'x', -2 * Math.PI, 2 * Math.PI).step(0.001);
			box_group_rotation_control.add(box_group.rotation, 'y', -2 * Math.PI, 2 * Math.PI).step(0.001);
			box_group_rotation_control.add(box_group.rotation, 'z', -2 * Math.PI, 2 * Math.PI).step(0.001);

			//cylinder_group.rotation.z += PI/10;
			//cylinder_group.rotation.x += PI/4;

			//			var spotlight_rotation_control = gui.addFolder('spotlight_rotation');
			//			spotlight_rotation_control.add(spotLight.rotation, 'x', -2 * Math.PI,2* Math.PI).step(0.001);
			//			spotlight_rotation_control.add(spotLight.rotation, 'y', -2 * Math.PI,2* Math.PI).step(0.001);
			//			spotlight_rotation_control.add(spotLight.rotation, 'z', -2 * Math.PI,2* Math.PI).step(0.001);
		}

		function init() {

			var width = window.innerWidth;
			var height = window.innerHeight;

			renderer = new THREE.WebGLRenderer({
				alpha: true
			});
			//				renderer = new THREE.WebGLRenderer({
			//				  setClearColor:0x000000,
			//				});
			document.body.appendChild(renderer.domElement);
			renderer.setSize(width, height);


			scene = new THREE.Scene();

			const light_ambient = new THREE.AmbientLight(0x7c7c7c); //0xeef2ff
			scene.add(light_ambient);

			camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 10000);

			//camera.position.set(-69.2446245253381, 244.86738497567643, -3.40116081944878);
			//camera.position.set(-4.974326929812538, 251.1934638330559, -53.647880644850275);
			camera.position.set(10.245126496820145, 244.4408261363762, -52.437908013976546);

			camera.rotation.set(-1.6591961412803802, 0.08212393176606579, 2.3948431028045545);
			//helper = new THREE.CameraHelper( camera );
			//scene.add( helper );

			//camera.lookAt(new THREE.Vector3(150, 150, -450))
			//camera.lookAt(new THREE.Vector3(0, 0, 0))
			scene.add(camera);


			cylinder_radius = 120;
			//				geometry = new THREE.SphereGeometry(cylinder_radius-1, 100, 100);
			//				material = new THREE.MeshLambertMaterial({
			//				  color: 0xeef6ff,
			//				  flatShading: true,
			//				});
			//
			//				mesh = new THREE.Mesh(geometry, material);
			//				mesh.receiveShadow = true;
			//				mesh.castShadow = true;
			//				mesh.position.y += 50;
			//				scene.add(mesh);

			cylinder_radius = 100;
			cylinder_group = new THREE.Group();
			divide = 80;
			for (i = 1; i < 81; i++) {
				abs_half = Math.abs(divide / 2 - i);
				//console.log(abs_half)
				where_i_want = cylinder_radius / (divide / 2);
				differ_radius = Math.sqrt((((divide / 2 * divide / 2) - (abs_half * abs_half)) * (cylinder_radius * cylinder_radius)) / (divide / 2 * divide / 2));

				geometry_cy = new THREE.CylinderGeometry(cylinder_radius * 3, cylinder_radius * 3, 2, 100);
				material_cy = new THREE.MeshLambertMaterial({
					color: 0xffffff,
					transparent: true,
				});
				
				tempGeo = new THREE.Mesh(geometry_cy, material_cy);
				
				mesh_test_group = new THREE.Group();
				mesh_test_group.add(tempGeo);
				
				
				add_box = new THREE.BoxGeometry(1000, 2, 1000, 32);
				add_box_mesh = new THREE.Mesh(add_box, material_cy);
				add_box_mesh.position.x += 200;
				add_box_mesh.position.z += 500;
				mesh_test_group.add(add_box_mesh);
				
				cylinder_group[i] = mesh_test_group;//new THREE.Mesh(add_box, material_cy);
				
				if (i - (divide / 2) > 0) {
					cylinder_group[i].position.y += abs_half * (where_i_want + 13);
					cylinder_group[i].position.x += abs_half * 10;
					cylinder_group[i].position.z -= abs_half * 10;
					//cylinder_group[i].rotation.y -= Math.PI/8;
				} else {
					continue;
					cylinder_group[i].position.y += abs_half * (where_i_want + 10);
					//cylinder_group[i].position.x += abs_half ;
				}
				cylinder_group[i].receiveShadow = true;
				//cylinder_group[i].castShadow = true;
				cylinder_group.add(cylinder_group[i])

			}
			//cylinder_group.rotation.z += PI/10;
			//cylinder_group.rotation.x += PI/4;
			//cylinder_group.rotation.set(-0.13, 0.009, 0);

			cylinder_group.position.set(-219.2, -263.3, 266.1);
			cylinder_group.rotation.set(-0.407, 0.009, -0.823);

			//cylinder_group.rotation.y += PI/4;
			scene.add(cylinder_group)


			box_group = new THREE.Group();
			divide_2 = 50;
			for (i = 1; i < 51; i++) {
				geometry_bx = new THREE.BoxGeometry(255, 1, 300, 200);
				material_bx = new THREE.MeshLambertMaterial({
					color: 0xffffff,
				});

				box_group[i] = new THREE.Mesh(geometry_bx, material_bx);

				box_group[i].rotation.z += i * (Math.PI / divide_2);
				box_group[i].receiveShadow = true;
				//box_group[i].castShadow = true;
				box_group.add(box_group[i])

			}
			//box_group.rotation.x += PI/8;
			//box_group.rotation.y += PI/6;
			//			box_group.rotation.x += PI / 2.3;
			//			box_group.rotation.y -= PI / 10;
			//			box_group.position.x = 110;
			//			box_group.position.z = 150;
			box_group.rotation.set(-0.269, -0.961, 0);
			box_group.position.set(-64.8, 133.7, -197.1);
			scene.add(box_group)


			spotLight = new THREE.SpotLight(0xcccccc);
			spotLight.castShadow = true;
			//spotLight.position.set( -650, -400, 580 );
			//spotLight.position.set(-439, 133.7, 1.4);
			//spotLight.position.set(-329.5, -307.4, -1000);
			//spotLight.position.set(596.91, 1200, 1100);
			spotLight.position.set(930.52, 930.52, 1658.3);
			//spotLight.shadow.mapSize.width = 524;
			//spotLight.shadow.mapSize.height = 524;
			spotLight.shadow.mapSize.width = 50;
			spotLight.shadow.mapSize.height = 50;
			//spotLight.angle = 0.5;
			spotLight.angle = 0.35;
			spotLight.target = cylinder_group;
			//spotLight.shadow.camera.near = 100;
			spotLight.shadow.camera.near = 250;
			//spotLight.shadow.camera.far = 4000;
			spotLight.shadow.camera.far = 150;
			spotLight.shadow.camera.fov = 50;

			scene.add(spotLight);

			spotLightHelper = new THREE.SpotLightHelper(spotLight);
			scene.add(spotLightHelper);

			spotLight_box = new THREE.SpotLight(0xcccccc);
			spotLight_box.castShadow = true;
			//spotLight_box.position.set(354.3, 729.3, 1000);
			//spotLight_box.position.set(-1000, 45.5, -1600);
			spotLight_box.position.set(-3000, 1200.2, 2386.3);
			//spotLight_box.rotation.set(0, 0, 0);
			spotLight_box.shadow.mapSize.width = 50;
			spotLight_box.shadow.mapSize.height = 50;
			spotLight_box.target = box_group;
			spotLight_box.angle = 0.25;
			spotLight_box.shadow.camera.near = 250;
			spotLight_box.shadow.camera.far = 150;
			spotLight_box.shadow.camera.fov = 50;

			scene.add(spotLight_box);

			spotLight_box_Helper = new THREE.SpotLightHelper(spotLight_box);
			scene.add(spotLight_box_Helper);

			document.body.appendChild(renderer.domElement);
			window.addEventListener('wheel', onMouseWheel, false);
			//document.addEventListener('touchmove', function(e) {e.preventDefault();}, true);
			window.addEventListener('touchmove', onMouseWheel, false);
			//controls = new THREE.OrbitControls(camera, renderer.domElement);
			addDatGui();


		}

		function onMouseWheel(event) {

			//event.preventDefault();
			console.log(cylinder_group.position.x);
			console.log(cylinder_group.position.z);
			
			if(cylinder_group.position.x < -235){
				cylinder_group.position.x = -219.2;
				cylinder_group.position.z = 266.1;
				cylinder_group.rotation.y = 0.009;
				
			}
			
			for (i = 0; i < 10; i++) {
				box_group.rotation.z -= 0.0001;
				cylinder_group.position.x -= 0.01;
				cylinder_group.position.z += 0.01;
				cylinder_group.rotation.y += 0.00001;
				//cylinder_group.position.y -= 0.01;
			}
			for (i = 0; i < 100; i++) {
				box_group.rotation.z -= 0.00005;
				cylinder_group.position.x -= 0.005;
				cylinder_group.position.z += 0.005;
				cylinder_group.rotation.y += 0.000005;
				//cylinder_group.position.y -= 0.05;
			}
			for (i = 0; i < 100; i++) {
				box_group.rotation.z -= 0.00003;
				cylinder_group.position.x -= 0.001;
				cylinder_group.position.z += 0.001;
				cylinder_group.rotation.y += 0.000001;
				//cylinder_group.position.y -= 0.001;
			}

		}

		function animate() {

			requestAnimationFrame(animate);
			render();

		}

		function render() {

			//cylinder_group.rotation.z -= 0.0001;
			//box_group.rotation.z += 0.0001;
			//console.log(camera.position);
			//console.log(camera.rotation);
			renderer.render(scene, camera);

		}
	</script>
</body></html>
